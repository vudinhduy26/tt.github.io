<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>M√≤ M√≤ M√≤</title>
  <link rel="stylesheet" href="./css/main.css">
  <link rel="stylesheet" href="./css/style.css">
  <style>
    /* Hi·ªáu ·ª©ng chuy·ªÉn c·∫£nh */
    .scene1, .scene2 {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
    }
    
    .scene1 {
      opacity: 1;
      z-index: 2;
    }
    
    .scene2 {
      opacity: 0;
      pointer-events: none;
      transition: opacity 2s ease-in-out;
      z-index: 1;
    }
    
    .scene2.show {
      opacity: 1;
      pointer-events: all;
    }
    
    /* ·∫®n scene 1 khi scene 2 hi·ªán */
    .scene1.hide {
      opacity: 0;
      pointer-events: none;
    }
    
    /* Tr√°nh xung ƒë·ªôt CSS gi·ªØa .star c·ªßa scene1 v√† scene2 */
    .scene1 .star {
      position: absolute;
    }
    
    .scene2 .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      box-shadow: 0 0 6px rgba(255,255,255,0.6);
      animation: twinkle infinite alternate;
    }
    
    @keyframes twinkle {
      from { opacity: 0.2; transform: scale(1); }
      to   { opacity: 1; transform: scale(1.3); }
    }
  </style>
</head>

<body>
  <!-- Scene 1: H·∫±ng Nga bay ƒë·∫øn m·∫∑t trƒÉng -->
  <div class="scene1" id="scene1">
    <div class="moonback">
      <div class="star"></div>
      <div class="star star2"></div>
      <div class="star star3"></div>
      <div class="star star4"></div>
      <div class="star star5"></div>
      <div class="star star6"></div>
      <div class="img"></div>
    </div>
  </div>

  <!-- Scene 2: B·∫ßu tr·ªùi ƒë√™m v·ªõi ƒë√®n l·ªìng v√† l·ªùi ch√∫c -->
  <div class="scene2" id="scene2">
    <div class="sky" id="sky">
      <div class="moon"></div>
    </div>

    <!-- üí¨ Popup l·ªùi ch√∫c -->
    <div class="wish-popup" id="wish-popup">
      <div class="wish-box">
        <p id="wish-text"></p>
        <button id="close-wish">ƒê√≥ng</button>
      </div>
    </div>
  </div>

  <script>
    // üéµ Kh·ªüi t·∫°o nh·∫°c n·ªÅn
    const audio = new Audio('./img/mid-autumn-festival-223227.mp3');
    audio.loop = true;
    audio.volume = 0.5;
    
    // X·ª≠ l√Ω l·ªói khi kh√¥ng t√¨m th·∫•y file nh·∫°c
    audio.addEventListener('error', function(e) {
      console.log('Kh√¥ng th·ªÉ t·∫£i file nh·∫°c:', e);
    });
    
    // Ph√°t nh·∫°c ngay khi trang load
    audio.play().then(() => {
      console.log('‚úÖ Nh·∫°c ƒë√£ t·ª± ƒë·ªông ph√°t th√†nh c√¥ng!');
    }).catch(e => {
      console.log('‚ùå Kh√¥ng th·ªÉ t·ª± ƒë·ªông ph√°t nh·∫°c:', e);
      // Th·ª≠ ph√°t nh·∫°c khi user t∆∞∆°ng t√°c
      document.addEventListener('click', () => {
        audio.play().then(() => {
          console.log('‚úÖ Nh·∫°c ƒë√£ ph√°t sau khi click!');
        }).catch(err => {
          console.log('‚ùå V·∫´n kh√¥ng th·ªÉ ph√°t nh·∫°c:', err);
        });
      }, { once: true });
    });
    
    // Ch·ªù animation H·∫±ng Nga ho√†n th√†nh (20s) r·ªìi chuy·ªÉn c·∫£nh
    setTimeout(() => {
      document.getElementById('scene1').classList.add('hide');
      document.getElementById('scene2').classList.add('show');
      initializeScene2();
    }, 20000);

    function initializeScene2() {
      const STAR_COUNT = 150;
      const LANTERN_COUNT = 20;
      const sky = document.getElementById("sky");

      // ‚≠ê T·∫°o sao
      for (let i = 0; i < STAR_COUNT; i++) {
        const star = document.createElement("div");
        star.className = "star";
        star.style.left = Math.random() * 100 + "vw";
        star.style.top = Math.random() * 100 + "vh";
        const size = Math.random() * 2 + 1;
        star.style.width = size + "px";
        star.style.height = size + "px";
        star.style.animationDuration = (Math.random() * 3 + 2) + "s";
        sky.appendChild(star);
      }

      // üåà M√†u ƒë√®n
      const colors = [
        ["#ffcc66", "#ff884d", "#cc4400"],
        ["#ffb6b6", "#ff7070", "#cc3030"],
        ["#ffd966", "#ffb84d", "#cc7722"],
        ["#ffb3ff", "#e066ff", "#9933cc"],
        ["#ffe6cc", "#ff9933", "#cc6600"]
      ];

      // üí´ L·ªùi ch√∫c
      const wishes = [
        // üåï Trung thu & b√¨nh an
        "Ch√∫c em m·ªôt ƒë√™m Trung thu tr√≤n ƒë·∫ßy √°nh trƒÉng v√† ti·∫øng c∆∞·ªùi üåï",
        "√Ånh trƒÉng s√°ng soi ƒë∆∞·ªùng, l√≤ng em m√£i an nhi√™n üåô",
        "Trung thu n√†y, ch√∫c em lu√¥n ·∫•m √°p v√† h·∫°nh ph√∫c ‚ù§Ô∏è",
        "Ch√∫c em t√¨m ƒë∆∞·ª£c s·ª± b√¨nh y√™n trong t·ª´ng kho·∫£nh kh·∫Øc üí´",
        "√Ånh trƒÉng ƒë√™m nay s·∫Ω mang ƒë·∫øn ƒëi·ªÅu ∆∞·ªõc ƒë·∫πp nh·∫•t cho em üå†",

        // üå∏ Ni·ªÅm vui & h·∫°nh ph√∫c
        "H√£y m·ªâm c∆∞·ªùi, v√¨ em ƒëang l√†m th·∫ø gi·ªõi n√†y ƒë·∫πp h∆°n üå∏",
        "Ni·ªÅm vui lu√¥n ·ªü quanh em, ch·ªâ c·∫ßn m·ªü l√≤ng üí´",
        "H√¥m nay l√† ng√†y tuy·ªát v·ªùi ƒë·ªÉ em h·∫°nh ph√∫c üíï",
        "Em x·ª©ng ƒë√°ng v·ªõi m·ªçi ƒëi·ªÅu t·ªët ƒë·∫πp nh·∫•t tr√™n ƒë·ªùi üå∑",
        "N·ª• c∆∞·ªùi c·ªßa em l√† ng·ªçn ƒë√®n s√°ng trong tim ng∆∞·ªùi kh√°c üíõ",

        // üåà May m·∫Øn & th√†nh c√¥ng
        "Ch√∫c em may m·∫Øn trong m·ªçi h√†nh tr√¨nh ph√≠a tr∆∞·ªõc üçÄ",
        "Th√†nh c√¥ng ƒëang ƒë·ª£i em, ch·ªâ c·∫ßn em kh√¥ng ng·ª´ng c·ªë g·∫Øng üí™",
        "M·ªói ∆∞·ªõc m∆° c·ªßa em ƒë·ªÅu ƒë√°ng ƒë∆∞·ª£c th·∫Øp s√°ng nh∆∞ ƒë√®n tr·ªùi üå†",
        "ƒê·ª´ng s·ª£ th·∫•t b·∫°i, v√¨ √°nh s√°ng ch·ªâ hi·ªán khi ƒë√™m xu·ªëng üåå",
        "Ch√∫c em m·ªôt h√†nh tr√¨nh ng·∫≠p tr√†n c∆° h·ªôi v√† ni·ªÅm vui üöÄ",

        // üïäÔ∏è B√¨nh an & t·ª± tin
        "H√£y tin v√†o ch√≠nh m√¨nh, em m·∫°nh m·∫Ω h∆°n em nghƒ© üí´",
        "B√¨nh an trong t√¢m h·ªìn l√† √°nh s√°ng ƒë·∫πp nh·∫•t üåø",
        "H√£y ƒë·ªÉ gi√≥ mang ƒëi n·ªói bu·ªìn, v√† trƒÉng mang ƒë·∫øn b√¨nh y√™n cho em üåæ",
        "M·ªçi kh√≥ khƒÉn r·ªìi s·∫Ω qua, ch·ªâ c·∫ßn em gi·ªØ ni·ªÅm tin üíñ",
        "Em ch√≠nh l√† √°nh s√°ng trong th·∫ø gi·ªõi c·ªßa ri√™ng anh üåü",

        // üå∏ D·ªÖ th∆∞∆°ng & c·ªï v≈©
        "C∆∞·ªùi m·ªôt c√°i nh√©, h√¥m nay tr·ªùi c≈©ng mu·ªën th·∫•y em vui üòä",
        "Em l√† l√Ω do khi·∫øn th·∫ø gi·ªõi n√†y d·ªãu d√†ng h∆°n üíê",
        "Kh√¥ng ai c√≥ th·ªÉ thay th·∫ø s·ª± ƒë·∫∑c bi·ªát c·ªßa em üíï",
        "Em x·ª©ng ƒë√°ng ƒë∆∞·ª£c y√™u th∆∞∆°ng, m·ªói ng√†y v√† m√£i m√£i üíù",
        "Ch√∫c em m·ªôt ng√†y th·∫≠t nh·∫π nh√†ng v√† ƒë·∫ßy y√™u th∆∞∆°ng üçÉ"
      ];

      const popup = document.getElementById("wish-popup");
      const wishText = document.getElementById("wish-text");
      const closeBtn = document.getElementById("close-wish");

      closeBtn.addEventListener("click", () => {
        popup.classList.remove("show");
      });

      // üèÆ T·∫°o ƒë√®n
      for (let i = 0; i < LANTERN_COUNT; i++) {
        const lantern = document.createElement("div");
        lantern.className = "lantern";

        const [c1, c2, c3] = colors[Math.floor(Math.random() * colors.length)];
        lantern.style.setProperty("--color1", c1);
        lantern.style.setProperty("--color2", c2);
        lantern.style.setProperty("--color3", c3);

        const size = Math.random() * 25 + 35;
        lantern.style.width = size + "px";
        lantern.style.height = size * 1.3 + "px";
        lantern.style.left = Math.random() * 100 + "vw";
        lantern.style.animationDuration = 15 + Math.random() * 20 + "s";
        lantern.style.animationDelay = Math.random() * 10 + "s";

        lantern.addEventListener("click", () => {
          const message = wishes[Math.floor(Math.random() * wishes.length)];
          wishText.textContent = message;
          popup.classList.add("show");

          clearTimeout(popup.hideTimeout);
          popup.hideTimeout = setTimeout(() => popup.classList.remove("show"), 5000);
        });

        sky.appendChild(lantern);
      }
    }
  </script>

</body>

</html>